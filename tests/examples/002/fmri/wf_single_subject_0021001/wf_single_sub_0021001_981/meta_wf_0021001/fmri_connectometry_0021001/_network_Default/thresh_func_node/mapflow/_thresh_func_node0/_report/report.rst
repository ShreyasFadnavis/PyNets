Node: utility
=============


 Hierarchy : _thresh_func_node0
 Exec ID : _thresh_func_node0


Original Inputs
---------------


* ID : 0021001
* atlas : DesikanKlein2012
* binary : False
* c_boot : 0
* conn_matrix : [[-2.03920632  0.43106068  0.          0.04314351  0.          0.34331076
   0.          0.11852957  0.          0.27650819  0.          0.27466575
   0.33295579  0.          0.1678271   0.          0.          0.
   0.          0.          0.08714262  0.        ]
 [ 0.43106068 -1.90721664  0.08157102  0.1524147   0.          0.
   0.09456576  0.          0.          0.          0.35764581  0.
   0.         -0.          0.62555077  0.          0.          0.
  -0.          0.          0.         -0.        ]
 [ 0.          0.08157102 -2.6235266   0.          0.24954536  0.
  -0.         -0.          0.16966884  0.36461715  0.12429774  0.
   0.22961303  0.          0.          1.1801045   0.          0.
   0.          0.          0.20584319  0.        ]
 [ 0.04314351  0.1524147   0.         -2.12180543  0.04785933  0.27631466
  -0.          0.          0.          0.          0.         -0.
   0.29708672  0.11319843  0.          0.05034257  0.99336033  0.
   0.          0.          0.          0.        ]
 [ 0.          0.          0.24954536  0.04785933 -1.45376112  0.
   0.         -0.          0.13698582  0.          0.30156113  0.
   0.15918825  0.01157989  0.          0.          0.13988837  0.
  -0.          0.          0.          0.        ]
 [ 0.34331076  0.          0.          0.27631466  0.         -1.59645067
   0.15177792  0.46713137  0.          0.          0.         -0.
   0.09509693  0.03771282  0.          0.          0.          0.01062495
   0.         -0.          0.          0.        ]
 [ 0.          0.09456576 -0.         -0.          0.          0.15177792
  -1.4022526   0.24950514  0.         -0.          0.14602717  0.10670883
   0.          0.          0.         -0.06505858 -0.          0.41900489
  -0.          0.          0.         -0.        ]
 [ 0.11852957  0.         -0.          0.         -0.          0.46713137
   0.24950514 -1.41193867  0.          0.         -0.          0.13633707
  -0.          0.          0.         -0.         -0.          0.
   0.0859003  -0.         -0.          0.        ]
 [ 0.          0.          0.16966884  0.          0.13698582  0.
   0.          0.         -2.25602445  0.39560309  0.          0.34308124
   0.09813521  0.26806568  0.14320498  0.          0.          0.
   0.          0.31470402  0.44714846  0.        ]
 [ 0.27650819  0.          0.36461715  0.          0.          0.
  -0.          0.          0.39560309 -2.18434909  0.          0.10287198
   0.07344866  0.20669372  0.15651802  0.23811878  0.          0.
   0.05597093  0.          0.23560921  0.05200272]
 [ 0.          0.35764581  0.12429774  0.          0.30156113  0.
   0.14602717 -0.          0.          0.         -1.99946037  0.
   0.42285018  0.          0.          0.          0.          0.08907438
   0.          0.56075635  0.          0.        ]
 [ 0.27466575  0.          0.         -0.          0.         -0.
   0.10670883  0.13633707  0.34308124  0.10287198  0.         -1.46762918
   0.          0.          0.07562668  0.         -0.          0.
   0.          0.11816121  0.          0.        ]
 [ 0.33295579  0.          0.22961303  0.29708672  0.15918825  0.09509693
   0.         -0.          0.09813521  0.07344866  0.42285018  0.
  -2.73769541  0.05341289  0.          0.00554857  0.03686225  0.
   0.          0.          1.04496486  0.        ]
 [ 0.         -0.          0.          0.11319843  0.01157989  0.03771282
   0.          0.          0.26806568  0.20669372  0.          0.
   0.05341289 -2.60316846  0.          0.          0.01817835  0.
   0.22873531  0.          0.07045032  1.46512465]
 [ 0.1678271   0.62555077  0.          0.          0.          0.
   0.          0.          0.14320498  0.15651802  0.          0.07562668
   0.          0.         -1.93443057  0.          0.22907261  0.02711104
   0.          0.12817012  0.24311576  0.        ]
 [ 0.          0.          1.1801045   0.05034257  0.          0.
  -0.06505858 -0.          0.          0.23811878  0.          0.
   0.00554857  0.          0.         -2.35425875  0.29977121  0.
   0.          0.          0.344138    0.        ]
 [ 0.          0.          0.          0.99336033  0.13988837  0.
  -0.         -0.          0.          0.          0.         -0.
   0.03686225  0.01817835  0.22907261  0.29977121 -2.41706973  0.
   0.16096237  0.          0.2311509   0.35085835]
 [ 0.          0.          0.          0.          0.          0.01062495
   0.41900489  0.          0.          0.          0.08907438  0.
   0.          0.          0.02711104  0.          0.         -1.40671607
   0.3608923   0.15252059  0.          0.        ]
 [ 0.         -0.          0.          0.         -0.          0.
  -0.          0.0859003   0.          0.05597093  0.          0.
   0.          0.22873531  0.          0.          0.16096237  0.3608923
  -1.85633941  0.          0.14648113  0.6522768 ]
 [ 0.          0.          0.          0.          0.         -0.
   0.         -0.          0.31470402  0.          0.56075635  0.11816121
   0.          0.          0.12817012  0.          0.          0.15252059
   0.         -1.74566078  0.1448179   0.13400561]
 [ 0.08714262  0.          0.20584319  0.          0.          0.
   0.         -0.          0.44714846  0.23560921  0.          0.
   1.04496486  0.07045032  0.24311576  0.344138    0.2311509   0.
   0.14648113  0.1448179  -3.03178627  0.04615476]
 [ 0.         -0.          0.          0.          0.          0.
  -0.          0.          0.          0.05200272  0.          0.
   0.          1.46512465  0.          0.          0.35085835  0.
   0.6522768   0.13400561  0.04615476 -2.7901946 ]]
* conn_model : sps
* coords : [[ 41.46036719  -7.7177768   44.17087537]
 [ 22.6098635   -4.56230735 -31.95640687]
 [ 46.24613187 -65.41561533  30.40984289]
 [ -3.64342857 -66.68971429 -23.60742857]
 [ -4.46764253 -50.63995891 -13.20005136]
 [-50.25136791 -10.39928915  -6.63124912]
 [ 25.51007813 -60.26367188  53.30015625]
 [-29.8504807  -89.22470943   1.50272636]
 [ 32.80915227 -86.42231717   2.04755712]
 [-57.46055697 -27.80877621 -12.65871519]
 [  5.86218182  37.532        2.95709091]
 [ 45.29406347 -21.88872143  43.83195177]
 [ -6.17316943 -25.68163193  57.79975058]
 [ 10.77466562 -15.93674272  -9.79040126]
 [ 46.06022409 -17.97478992   8.11204482]
 [ 13.6988191  -66.42386874  -5.03918905]
 [ 49.02416244 -28.17928934 -27.29678511]
 [-13.29384318 -67.50893365  -5.87891203]
 [ 26.30807397 -20.53450609 -12.81235904]
 [  5.4625651   21.54329427  28.04296875]
 [-48.32543193 -28.42695232 -28.30117484]
 [  7.90322581 -44.98354839  19.30645161]]
* dens_thresh : True
* dir_path : /Users/derekpisner/Applications/PyNets/tests/examples/002/fmri/DesikanKlein2012
* disp_filt : False
* function_str : def thresh_func(dens_thresh, thr, conn_matrix, conn_model, network, ID, dir_path, roi, node_size, min_span_tree,
                smooth, disp_filt, parc, prune, atlas, uatlas, labels, coords, c_boot, norm, binary,
                hpass):
    """
    Threshold a functional connectivity matrix using any of a variety of methods.

    Parameters
    ----------
    dens_thresh : bool
        Indicates whether a target graph density is to be used as the basis for
        thresholding.
    thr : float
        A value, between 0 and 1, to threshold the graph using any variety of methods
        triggered through other options.
    conn_matrix : array
        Adjacency matrix stored as an m x n array of nodes and edges.
    conn_model : str
       Connectivity estimation model (e.g. corr for correlation, cov for covariance, sps for precision covariance,
       partcorr for partial correlation). sps type is used by default.
    network : str
        Resting-state network based on Yeo-7 and Yeo-17 naming (e.g. 'Default') used to filter nodes in the study of
        brain subgraphs.
    ID : str
        A subject id or other unique identifier.
    dir_path : str
        Path to directory containing subject derivative data for given run.
    roi : str
        File path to binarized/boolean region-of-interest Nifti1Image file.
    node_size : int
        Spherical centroid node size in the case that coordinate-based centroids
        are used as ROI's.
    min_span_tree : bool
        Indicates whether local thresholding from the Minimum Spanning Tree
        should be used.
    smooth : int
        Smoothing width (mm fwhm) to apply to time-series when extracting signal from ROI's.
    disp_filt : bool
        Indicates whether local thresholding using a disparity filter and
        'backbone network' should be used.
    parc : bool
        Indicates whether to use parcels instead of coordinates as ROI nodes.
    prune : bool
        Indicates whether to prune final graph of disconnected nodes/isolates.
    atlas : str
        Name of atlas parcellation used.
    uatlas : str
        File path to atlas parcellation Nifti1Image in MNI template space.
    labels : list
        List of string labels corresponding to ROI nodes.
    coords : list
        List of (x, y, z) tuples corresponding to a coordinate atlas used or
        which represent the center-of-mass of each parcellation node.
    c_boot : int
        Number of bootstraps if user specified circular-block bootstrapped resampling of the node-extracted time-series.
    norm : int
        Indicates method of normalizing resulting graph.
    binary : bool
        Indicates whether to binarize resulting graph edges to form an
        unweighted graph.
    hpass : bool
        High-pass filter values (Hz) to apply to node-extracted time-series.

    Returns
    -------
    conn_matrix_thr : array
        Weighted, thresholded, NxN matrix.
    edge_threshold : str
        The string percentage representation of thr.
    est_path : str
        File path to the thresholded graph, conn_matrix_thr, saved as a numpy array in .npy format.
    thr : float
        The value, between 0 and 1, used to threshold the graph using any variety of methods
        triggered through other options.
    node_size : int
        Spherical centroid node size in the case that coordinate-based centroids
        are used as ROI's.
    network : str
        Resting-state network based on Yeo-7 and Yeo-17 naming (e.g. 'Default') used to filter nodes in the study of
        brain subgraphs.
    conn_model : str
       Connectivity estimation model (e.g. corr for correlation, cov for covariance, sps for precision covariance,
       partcorr for partial correlation). sps type is used by default.
    roi : str
        File path to binarized/boolean region-of-interest Nifti1Image file.
    smooth : int
        Smoothing width (mm fwhm) to apply to time-series when extracting signal from ROI's.
    prune : bool
        Indicates whether to prune final graph of disconnected nodes/isolates.
    ID : str
        A subject id or other unique identifier.
    dir_path : str
        Path to directory containing subject derivative data for given run.
    atlas : str
        Name of atlas parcellation used.
    uatlas : str
        File path to atlas parcellation Nifti1Image in MNI template space.
    labels : list
        List of string labels corresponding to ROI nodes.
    coords : list
        List of (x, y, z) tuples corresponding to a coordinate atlas used or
        which represent the center-of-mass of each parcellation node.
    c_boot : int
        Number of bootstraps if user specified circular-block bootstrapped resampling of the node-extracted time-series.
    norm : int
        Indicates method of normalizing resulting graph.
    binary : bool
        Indicates whether to binarize resulting graph edges to form an
        unweighted graph.
    hpass : bool
        High-pass filter values (Hz) to apply to node-extracted time-series.
    """
    import warnings
    warnings.filterwarnings("ignore")
    from pynets import utils, thresholding

    thr_perc = 100 * float(thr)
    edge_threshold = "%s%s" % (str(thr_perc), '%')
    if parc is True:
        node_size = 'parc'

    if np.count_nonzero(conn_matrix) == 0:
        raise ValueError('ERROR: Raw connectivity matrix contains only zeros.')

    # Save unthresholded
    unthr_path = utils.create_unthr_path(ID, network, conn_model, roi, dir_path)
    utils.save_mat(conn_matrix, unthr_path)

    if min_span_tree is True:
        print('Using local thresholding option with the Minimum Spanning Tree (MST)...\n')
        if dens_thresh is False:
            thr_type = 'MSTprop'
            conn_matrix_thr = thresholding.local_thresholding_prop(conn_matrix, thr)
        else:
            thr_type = 'MSTdens'
            conn_matrix_thr = thresholding.local_thresholding_dens(conn_matrix, thr)
    elif disp_filt is True:
        thr_type = 'DISP_alpha'
        G1 = thresholding.disparity_filter(nx.from_numpy_array(conn_matrix))
        # G2 = nx.Graph([(u, v, d) for u, v, d in G1.edges(data=True) if d['alpha'] < thr])
        print('Computing edge disparity significance with alpha = %s' % thr)
        print('Filtered graph: nodes = %s, edges = %s' % (G1.number_of_nodes(), G1.number_of_edges()))
        # print('Backbone graph: nodes = %s, edges = %s' % (G2.number_of_nodes(), G2.number_of_edges()))
        # print(G2.edges(data=True))
        conn_matrix_thr = nx.to_numpy_array(G1)
    else:
        if dens_thresh is False:
            thr_type = 'prop'
            print("%s%.2f%s" % ('\nThresholding proportionally at: ', thr_perc, '% ...\n'))
            conn_matrix_thr = thresholding.threshold_proportional(conn_matrix, float(thr))
        else:
            thr_type = 'dens'
            print("%s%.2f%s" % ('\nThresholding to achieve density of: ', thr_perc, '% ...\n'))
            conn_matrix_thr = thresholding.density_thresholding(conn_matrix, float(thr))

    if not nx.is_connected(nx.from_numpy_matrix(conn_matrix_thr)):
        print('Warning: Fragmented graph')

    # Save thresholded mat
    est_path = utils.create_est_path_func(ID, network, conn_model, thr, roi, dir_path, node_size, smooth, c_boot,
                                          thr_type, hpass, parc)

    utils.save_mat(conn_matrix_thr, est_path)

    return conn_matrix_thr, edge_threshold, est_path, thr, node_size, network, conn_model, roi, smooth, prune, ID, dir_path, atlas, uatlas, labels, coords, c_boot, norm, binary, hpass

* hpass : None
* labels : [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan]
* min_span_tree : False
* network : Default
* node_size : None
* norm : 0
* parc : True
* prune : 1
* roi : None
* smooth : 0
* thr : 0.15
* uatlas : /Users/derekpisner/Applications/PyNets/tests/examples/002/fmri/reg_fmri/anat_reg/DesikanKlein2012_t1w_mni_gm.nii.gz

Execution Inputs
----------------


* ID : 0021001
* atlas : DesikanKlein2012
* binary : False
* c_boot : 0
* conn_matrix : [[ 0.          0.43106068  0.          0.04314351  0.          0.34331076
   0.          0.11852957  0.          0.27650819  0.          0.27466575
   0.33295579  0.          0.1678271   0.          0.          0.
   0.          0.          0.08714262  0.        ]
 [ 0.43106068  0.          0.08157102  0.1524147   0.          0.
   0.09456576  0.          0.          0.          0.35764581  0.
   0.         -0.          0.62555077  0.          0.          0.
  -0.          0.          0.         -0.        ]
 [ 0.          0.08157102  0.          0.          0.24954536  0.
  -0.         -0.          0.16966884  0.36461715  0.12429774  0.
   0.22961303  0.          0.          1.1801045   0.          0.
   0.          0.          0.20584319  0.        ]
 [ 0.04314351  0.1524147   0.          0.          0.04785933  0.27631466
  -0.          0.          0.          0.          0.         -0.
   0.29708672  0.11319843  0.          0.05034257  0.99336033  0.
   0.          0.          0.          0.        ]
 [ 0.          0.          0.24954536  0.04785933  0.          0.
   0.         -0.          0.13698582  0.          0.30156113  0.
   0.15918825  0.01157989  0.          0.          0.13988837  0.
  -0.          0.          0.          0.        ]
 [ 0.34331076  0.          0.          0.27631466  0.          0.
   0.15177792  0.46713137  0.          0.          0.         -0.
   0.09509693  0.03771282  0.          0.          0.          0.01062495
   0.         -0.          0.          0.        ]
 [ 0.          0.09456576 -0.         -0.          0.          0.15177792
   0.          0.24950514  0.         -0.          0.14602717  0.10670883
   0.          0.          0.         -0.06505858 -0.          0.41900489
  -0.          0.          0.         -0.        ]
 [ 0.11852957  0.         -0.          0.         -0.          0.46713137
   0.24950514  0.          0.          0.         -0.          0.13633707
  -0.          0.          0.         -0.         -0.          0.
   0.0859003  -0.         -0.          0.        ]
 [ 0.          0.          0.16966884  0.          0.13698582  0.
   0.          0.          0.          0.39560309  0.          0.34308124
   0.09813521  0.26806568  0.14320498  0.          0.          0.
   0.          0.31470402  0.44714846  0.        ]
 [ 0.27650819  0.          0.36461715  0.          0.          0.
  -0.          0.          0.39560309  0.          0.          0.10287198
   0.07344866  0.20669372  0.15651802  0.23811878  0.          0.
   0.05597093  0.          0.23560921  0.05200272]
 [ 0.          0.35764581  0.12429774  0.          0.30156113  0.
   0.14602717 -0.          0.          0.          0.          0.
   0.42285018  0.          0.          0.          0.          0.08907438
   0.          0.56075635  0.          0.        ]
 [ 0.27466575  0.          0.         -0.          0.         -0.
   0.10670883  0.13633707  0.34308124  0.10287198  0.          0.
   0.          0.          0.07562668  0.         -0.          0.
   0.          0.11816121  0.          0.        ]
 [ 0.33295579  0.          0.22961303  0.29708672  0.15918825  0.09509693
   0.         -0.          0.09813521  0.07344866  0.42285018  0.
   0.          0.05341289  0.          0.00554857  0.03686225  0.
   0.          0.          1.04496486  0.        ]
 [ 0.         -0.          0.          0.11319843  0.01157989  0.03771282
   0.          0.          0.26806568  0.20669372  0.          0.
   0.05341289  0.          0.          0.          0.01817835  0.
   0.22873531  0.          0.07045032  1.46512465]
 [ 0.1678271   0.62555077  0.          0.          0.          0.
   0.          0.          0.14320498  0.15651802  0.          0.07562668
   0.          0.          0.          0.          0.22907261  0.02711104
   0.          0.12817012  0.24311576  0.        ]
 [ 0.          0.          1.1801045   0.05034257  0.          0.
  -0.06505858 -0.          0.          0.23811878  0.          0.
   0.00554857  0.          0.          0.          0.29977121  0.
   0.          0.          0.344138    0.        ]
 [ 0.          0.          0.          0.99336033  0.13988837  0.
  -0.         -0.          0.          0.          0.         -0.
   0.03686225  0.01817835  0.22907261  0.29977121  0.          0.
   0.16096237  0.          0.2311509   0.35085835]
 [ 0.          0.          0.          0.          0.          0.01062495
   0.41900489  0.          0.          0.          0.08907438  0.
   0.          0.          0.02711104  0.          0.          0.
   0.3608923   0.15252059  0.          0.        ]
 [ 0.         -0.          0.          0.         -0.          0.
  -0.          0.0859003   0.          0.05597093  0.          0.
   0.          0.22873531  0.          0.          0.16096237  0.3608923
   0.          0.          0.14648113  0.6522768 ]
 [ 0.          0.          0.          0.          0.         -0.
   0.         -0.          0.31470402  0.          0.56075635  0.11816121
   0.          0.          0.12817012  0.          0.          0.15252059
   0.          0.          0.1448179   0.13400561]
 [ 0.08714262  0.          0.20584319  0.          0.          0.
   0.         -0.          0.44714846  0.23560921  0.          0.
   1.04496486  0.07045032  0.24311576  0.344138    0.2311509   0.
   0.14648113  0.1448179   0.          0.04615476]
 [ 0.         -0.          0.          0.          0.          0.
  -0.          0.          0.          0.05200272  0.          0.
   0.          1.46512465  0.          0.          0.35085835  0.
   0.6522768   0.13400561  0.04615476  0.        ]]
* conn_model : sps
* coords : [[ 41.46036719  -7.7177768   44.17087537]
 [ 22.6098635   -4.56230735 -31.95640687]
 [ 46.24613187 -65.41561533  30.40984289]
 [ -3.64342857 -66.68971429 -23.60742857]
 [ -4.46764253 -50.63995891 -13.20005136]
 [-50.25136791 -10.39928915  -6.63124912]
 [ 25.51007813 -60.26367188  53.30015625]
 [-29.8504807  -89.22470943   1.50272636]
 [ 32.80915227 -86.42231717   2.04755712]
 [-57.46055697 -27.80877621 -12.65871519]
 [  5.86218182  37.532        2.95709091]
 [ 45.29406347 -21.88872143  43.83195177]
 [ -6.17316943 -25.68163193  57.79975058]
 [ 10.77466562 -15.93674272  -9.79040126]
 [ 46.06022409 -17.97478992   8.11204482]
 [ 13.6988191  -66.42386874  -5.03918905]
 [ 49.02416244 -28.17928934 -27.29678511]
 [-13.29384318 -67.50893365  -5.87891203]
 [ 26.30807397 -20.53450609 -12.81235904]
 [  5.4625651   21.54329427  28.04296875]
 [-48.32543193 -28.42695232 -28.30117484]
 [  7.90322581 -44.98354839  19.30645161]]
* dens_thresh : True
* dir_path : /Users/derekpisner/Applications/PyNets/tests/examples/002/fmri/DesikanKlein2012
* disp_filt : False
* function_str : def thresh_func(dens_thresh, thr, conn_matrix, conn_model, network, ID, dir_path, roi, node_size, min_span_tree,
                smooth, disp_filt, parc, prune, atlas, uatlas, labels, coords, c_boot, norm, binary,
                hpass):
    """
    Threshold a functional connectivity matrix using any of a variety of methods.

    Parameters
    ----------
    dens_thresh : bool
        Indicates whether a target graph density is to be used as the basis for
        thresholding.
    thr : float
        A value, between 0 and 1, to threshold the graph using any variety of methods
        triggered through other options.
    conn_matrix : array
        Adjacency matrix stored as an m x n array of nodes and edges.
    conn_model : str
       Connectivity estimation model (e.g. corr for correlation, cov for covariance, sps for precision covariance,
       partcorr for partial correlation). sps type is used by default.
    network : str
        Resting-state network based on Yeo-7 and Yeo-17 naming (e.g. 'Default') used to filter nodes in the study of
        brain subgraphs.
    ID : str
        A subject id or other unique identifier.
    dir_path : str
        Path to directory containing subject derivative data for given run.
    roi : str
        File path to binarized/boolean region-of-interest Nifti1Image file.
    node_size : int
        Spherical centroid node size in the case that coordinate-based centroids
        are used as ROI's.
    min_span_tree : bool
        Indicates whether local thresholding from the Minimum Spanning Tree
        should be used.
    smooth : int
        Smoothing width (mm fwhm) to apply to time-series when extracting signal from ROI's.
    disp_filt : bool
        Indicates whether local thresholding using a disparity filter and
        'backbone network' should be used.
    parc : bool
        Indicates whether to use parcels instead of coordinates as ROI nodes.
    prune : bool
        Indicates whether to prune final graph of disconnected nodes/isolates.
    atlas : str
        Name of atlas parcellation used.
    uatlas : str
        File path to atlas parcellation Nifti1Image in MNI template space.
    labels : list
        List of string labels corresponding to ROI nodes.
    coords : list
        List of (x, y, z) tuples corresponding to a coordinate atlas used or
        which represent the center-of-mass of each parcellation node.
    c_boot : int
        Number of bootstraps if user specified circular-block bootstrapped resampling of the node-extracted time-series.
    norm : int
        Indicates method of normalizing resulting graph.
    binary : bool
        Indicates whether to binarize resulting graph edges to form an
        unweighted graph.
    hpass : bool
        High-pass filter values (Hz) to apply to node-extracted time-series.

    Returns
    -------
    conn_matrix_thr : array
        Weighted, thresholded, NxN matrix.
    edge_threshold : str
        The string percentage representation of thr.
    est_path : str
        File path to the thresholded graph, conn_matrix_thr, saved as a numpy array in .npy format.
    thr : float
        The value, between 0 and 1, used to threshold the graph using any variety of methods
        triggered through other options.
    node_size : int
        Spherical centroid node size in the case that coordinate-based centroids
        are used as ROI's.
    network : str
        Resting-state network based on Yeo-7 and Yeo-17 naming (e.g. 'Default') used to filter nodes in the study of
        brain subgraphs.
    conn_model : str
       Connectivity estimation model (e.g. corr for correlation, cov for covariance, sps for precision covariance,
       partcorr for partial correlation). sps type is used by default.
    roi : str
        File path to binarized/boolean region-of-interest Nifti1Image file.
    smooth : int
        Smoothing width (mm fwhm) to apply to time-series when extracting signal from ROI's.
    prune : bool
        Indicates whether to prune final graph of disconnected nodes/isolates.
    ID : str
        A subject id or other unique identifier.
    dir_path : str
        Path to directory containing subject derivative data for given run.
    atlas : str
        Name of atlas parcellation used.
    uatlas : str
        File path to atlas parcellation Nifti1Image in MNI template space.
    labels : list
        List of string labels corresponding to ROI nodes.
    coords : list
        List of (x, y, z) tuples corresponding to a coordinate atlas used or
        which represent the center-of-mass of each parcellation node.
    c_boot : int
        Number of bootstraps if user specified circular-block bootstrapped resampling of the node-extracted time-series.
    norm : int
        Indicates method of normalizing resulting graph.
    binary : bool
        Indicates whether to binarize resulting graph edges to form an
        unweighted graph.
    hpass : bool
        High-pass filter values (Hz) to apply to node-extracted time-series.
    """
    import warnings
    warnings.filterwarnings("ignore")
    from pynets import utils, thresholding

    thr_perc = 100 * float(thr)
    edge_threshold = "%s%s" % (str(thr_perc), '%')
    if parc is True:
        node_size = 'parc'

    if np.count_nonzero(conn_matrix) == 0:
        raise ValueError('ERROR: Raw connectivity matrix contains only zeros.')

    # Save unthresholded
    unthr_path = utils.create_unthr_path(ID, network, conn_model, roi, dir_path)
    utils.save_mat(conn_matrix, unthr_path)

    if min_span_tree is True:
        print('Using local thresholding option with the Minimum Spanning Tree (MST)...\n')
        if dens_thresh is False:
            thr_type = 'MSTprop'
            conn_matrix_thr = thresholding.local_thresholding_prop(conn_matrix, thr)
        else:
            thr_type = 'MSTdens'
            conn_matrix_thr = thresholding.local_thresholding_dens(conn_matrix, thr)
    elif disp_filt is True:
        thr_type = 'DISP_alpha'
        G1 = thresholding.disparity_filter(nx.from_numpy_array(conn_matrix))
        # G2 = nx.Graph([(u, v, d) for u, v, d in G1.edges(data=True) if d['alpha'] < thr])
        print('Computing edge disparity significance with alpha = %s' % thr)
        print('Filtered graph: nodes = %s, edges = %s' % (G1.number_of_nodes(), G1.number_of_edges()))
        # print('Backbone graph: nodes = %s, edges = %s' % (G2.number_of_nodes(), G2.number_of_edges()))
        # print(G2.edges(data=True))
        conn_matrix_thr = nx.to_numpy_array(G1)
    else:
        if dens_thresh is False:
            thr_type = 'prop'
            print("%s%.2f%s" % ('\nThresholding proportionally at: ', thr_perc, '% ...\n'))
            conn_matrix_thr = thresholding.threshold_proportional(conn_matrix, float(thr))
        else:
            thr_type = 'dens'
            print("%s%.2f%s" % ('\nThresholding to achieve density of: ', thr_perc, '% ...\n'))
            conn_matrix_thr = thresholding.density_thresholding(conn_matrix, float(thr))

    if not nx.is_connected(nx.from_numpy_matrix(conn_matrix_thr)):
        print('Warning: Fragmented graph')

    # Save thresholded mat
    est_path = utils.create_est_path_func(ID, network, conn_model, thr, roi, dir_path, node_size, smooth, c_boot,
                                          thr_type, hpass, parc)

    utils.save_mat(conn_matrix_thr, est_path)

    return conn_matrix_thr, edge_threshold, est_path, thr, node_size, network, conn_model, roi, smooth, prune, ID, dir_path, atlas, uatlas, labels, coords, c_boot, norm, binary, hpass

* hpass : None
* labels : [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan]
* min_span_tree : False
* network : Default
* node_size : None
* norm : 0
* parc : True
* prune : 1
* roi : None
* smooth : 0
* thr : 0.15
* uatlas : /Users/derekpisner/Applications/PyNets/tests/examples/002/fmri/reg_fmri/anat_reg/DesikanKlein2012_t1w_mni_gm.nii.gz


Execution Outputs
-----------------


* ID : 0021001
* atlas : DesikanKlein2012
* binary : False
* c_boot : 0
* conn_matrix_thr : [[0.         0.43106068 0.         0.         0.         0.34331076
  0.         0.         0.         0.27650819 0.         0.27466575
  0.33295579 0.         0.         0.         0.         0.
  0.         0.         0.         0.        ]
 [0.43106068 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.35764581 0.
  0.         0.         0.62555077 0.         0.         0.
  0.         0.         0.         0.        ]
 [0.         0.         0.         0.         0.24954536 0.
  0.         0.         0.         0.36461715 0.         0.
  0.         0.         0.         1.1801045  0.         0.
  0.         0.         0.         0.        ]
 [0.         0.         0.         0.         0.         0.27631466
  0.         0.         0.         0.         0.         0.
  0.29708672 0.         0.         0.         0.99336033 0.
  0.         0.         0.         0.        ]
 [0.         0.         0.24954536 0.         0.         0.
  0.         0.         0.         0.         0.30156113 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.        ]
 [0.34331076 0.         0.         0.27631466 0.         0.
  0.         0.46713137 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.24950514 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.41900489
  0.         0.         0.         0.        ]
 [0.         0.         0.         0.         0.         0.46713137
  0.24950514 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.39560309 0.         0.34308124
  0.         0.26806568 0.         0.         0.         0.
  0.         0.31470402 0.44714846 0.        ]
 [0.27650819 0.         0.36461715 0.         0.         0.
  0.         0.         0.39560309 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.        ]
 [0.         0.35764581 0.         0.         0.30156113 0.
  0.         0.         0.         0.         0.         0.
  0.42285018 0.         0.         0.         0.         0.
  0.         0.56075635 0.         0.        ]
 [0.27466575 0.         0.         0.         0.         0.
  0.         0.         0.34308124 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.        ]
 [0.33295579 0.         0.         0.29708672 0.         0.
  0.         0.         0.         0.         0.42285018 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         1.04496486 0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.26806568 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         1.46512465]
 [0.         0.62555077 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.24311576 0.        ]
 [0.         0.         1.1801045  0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.29977121 0.
  0.         0.         0.344138   0.        ]
 [0.         0.         0.         0.99336033 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.29977121 0.         0.
  0.         0.         0.         0.35085835]
 [0.         0.         0.         0.         0.         0.
  0.41900489 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.3608923  0.         0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.3608923
  0.         0.         0.         0.6522768 ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.31470402 0.         0.56075635 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.44714846 0.         0.         0.
  1.04496486 0.         0.24311576 0.344138   0.         0.
  0.         0.         0.         0.        ]
 [0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         1.46512465 0.         0.         0.35085835 0.
  0.6522768  0.         0.         0.        ]]
* conn_model : sps
* coords : [[ 41.46036719  -7.7177768   44.17087537]
 [ 22.6098635   -4.56230735 -31.95640687]
 [ 46.24613187 -65.41561533  30.40984289]
 [ -3.64342857 -66.68971429 -23.60742857]
 [ -4.46764253 -50.63995891 -13.20005136]
 [-50.25136791 -10.39928915  -6.63124912]
 [ 25.51007813 -60.26367188  53.30015625]
 [-29.8504807  -89.22470943   1.50272636]
 [ 32.80915227 -86.42231717   2.04755712]
 [-57.46055697 -27.80877621 -12.65871519]
 [  5.86218182  37.532        2.95709091]
 [ 45.29406347 -21.88872143  43.83195177]
 [ -6.17316943 -25.68163193  57.79975058]
 [ 10.77466562 -15.93674272  -9.79040126]
 [ 46.06022409 -17.97478992   8.11204482]
 [ 13.6988191  -66.42386874  -5.03918905]
 [ 49.02416244 -28.17928934 -27.29678511]
 [-13.29384318 -67.50893365  -5.87891203]
 [ 26.30807397 -20.53450609 -12.81235904]
 [  5.4625651   21.54329427  28.04296875]
 [-48.32543193 -28.42695232 -28.30117484]
 [  7.90322581 -44.98354839  19.30645161]]
* dir_path : /Users/derekpisner/Applications/PyNets/tests/examples/002/fmri/DesikanKlein2012
* edge_threshold : 15.0%
* est_path : /Users/derekpisner/Applications/PyNets/tests/examples/002/fmri/DesikanKlein2012/graphs/0021001_Default_est_sps_0.15densparc_mm.npy
* hpass : None
* labels : [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan
 nan nan nan nan]
* network : Default
* node_size : parc
* norm : 0
* prune : 1
* roi : None
* smooth : 0
* thr : 0.15
* uatlas : /Users/derekpisner/Applications/PyNets/tests/examples/002/fmri/reg_fmri/anat_reg/DesikanKlein2012_t1w_mni_gm.nii.gz


Runtime info
------------


* duration : 0.031469
* hostname : dpys
* prev_wd : /Users/derekpisner/Applications/PyNets
* working_dir : /Users/derekpisner/Applications/PyNets/tests/examples/002/fmri/wf_single_subject_0021001/wf_single_sub_0021001_981/meta_wf_0021001/fmri_connectometry_0021001/_network_Default/thresh_func_node/mapflow/_thresh_func_node0


Environment
~~~~~~~~~~~


* ANTSPATH : /Users/derekpisner/bin/ants/bin/
* Apple_PubSub_Socket_Render : /private/tmp/com.apple.launchd.VKfenSaB7x/Render
* CONDA_DEFAULT_ENV : base
* CONDA_EXE : /usr/local/anaconda3/bin/conda
* CONDA_PREFIX : /usr/local/anaconda3
* CONDA_PROMPT_MODIFIER : (base) 
* CONDA_SHLVL : 1
* CPPFLAGS : -I/usr/local/opt/libxml2/include
* DISPLAY : dpys:0.0
* DYLD_LIBRARY_PATH : /Applications/freesurfer/lib/gcc/lib::/opt/X11/lib/flat_namespace
* FIX_VERTEX_AREA : 
* FMRI_ANALYSIS_DIR : /Applications/freesurfer/fsfast
* FREESURFER_HOME : /Applications/freesurfer
* FSFAST_HOME : /Applications/freesurfer/fsfast
* FSF_OUTPUT_FORMAT : nii.gz
* FSLDIR : /usr/local/fsl
* FSLGECUDAQ : cuda.q
* FSLLOCKDIR : 
* FSLMACHINELIST : 
* FSLMULTIFILEQUIT : TRUE
* FSLOUTPUTTYPE : NIFTI_GZ
* FSLREMOTECALL : 
* FSLTCLSH : /usr/local/fsl/bin/fsltclsh
* FSLWISH : /usr/local/fsl/bin/fslwish
* FSL_BIN : /usr/local/fsl/bin
* FSL_DIR : /usr/local/fsl
* FS_OVERRIDE : 0
* FUNCTIONALS_DIR : /Applications/freesurfer/sessions
* HOME : /Users/derekpisner
* LANG : en_US.UTF-8
* LDFLAGS : -L/usr/local/opt/libxml2/lib
* LOCAL_DIR : /Applications/freesurfer/local
* LOGNAME : derekpisner
* MINC_BIN_DIR : /Applications/freesurfer/mni/bin
* MINC_LIB_DIR : /Applications/freesurfer/mni/lib
* MNI_DATAPATH : /Applications/freesurfer/mni/data
* MNI_DIR : /Applications/freesurfer/mni
* MNI_PERL5LIB : /Applications/freesurfer/mni/lib/../Library/Perl/Updates/5.12.3
* OLDPWD : /Users/derekpisner/Applications/PyNets/tests
* OS : Darwin
* PATH : /Users/derekpisner/bin/ants/bin/:/usr/local/opt/libxml2/bin:/Applications/freesurfer/bin:/Applications/freesurfer/fsfast/bin:/Applications/freesurfer/tktools:/usr/local/fsl/bin:/Applications/freesurfer/mni/bin:/usr/local/fsl/bin:/Users/derekpisner/anaconda3/bin:/Users/derekpisner/bin/ants/bin/:/usr/local/opt/libxml2/bin:/Applications/freesurfer/bin:/Applications/freesurfer/fsfast/bin:/Applications/freesurfer/tktools:/usr/local/fsl/bin:/Applications/freesurfer/mni/bin:/usr/local/fsl/bin:/usr/local/anaconda3/bin:/usr/local/anaconda3/condabin:/Users/derekpisner/anaconda3/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/Library/TeX/texbin:/opt/X11/bin:/Users/derekpisner/abin:/Users/derekpisner/abin
* PERL5LIB : /Applications/freesurfer/mni/lib/../Library/Perl/Updates/5.12.3
* PWD : /Users/derekpisner/Applications/PyNets
* SHELL : /bin/bash
* SHLVL : 3
* SSH_AUTH_SOCK : /private/tmp/com.apple.launchd.qmAkE8F40f/Listeners
* SUBJECTS_DIR : /Applications/freesurfer/subjects
* TERM : xterm-256color
* TERM_PROGRAM : Apple_Terminal
* TERM_PROGRAM_VERSION : 421.1.1
* TERM_SESSION_ID : 6432F315-D86A-4D51-A77C-DB02F4938E15
* TMPDIR : /var/folders/r1/p8kclf5j3v74m4l5l4__jty00000gn/T/
* USER : derekpisner
* XPC_FLAGS : 0x0
* XPC_SERVICE_NAME : 0
* _ : /usr/local/anaconda3/bin/pynets_run.py
* _CE_CONDA : 
* _CE_M : 
* __CF_USER_TEXT_ENCODING : 0x1F5:0x0:0x0

